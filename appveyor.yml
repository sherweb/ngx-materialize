image: Visual Studio 2017

branches:
  only:
    - master

environment:
  matrix:
    - nodejs_version: "8"

platform:
  - x64

install:
  - ps: Install-Product node $env:nodejs_version
  - cd lib && yarn install --frozen-lockfile --no-progress && cd ..
  - yarn build:lib
  - cd dist/lib && npm pack
  - 7z x ngx-materialize-*.tgz && 7z x ngx-materialize-*.tar
  - cd package && yarn link && cd ../../..
  - yarn install --frozen-lockfile --no-progress
  - yarn link ngx-materialize

test_script:
  - node --version
  - npm --version
  - yarn --version
  - yarn lint
  - yarn build:demo --prod --no-progress

after_test:
  - yarn unlink ngx-materialize
  - cd dist/lib/package && yarn unlink

build: off

cache:
  - node_modules -> yarn.lock
  - lib/node_modules -> lib/yarn.lock
  - "%LOCALAPPDATA%/Yarn"
